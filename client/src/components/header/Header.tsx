import { FC } from "react";
import { Link } from "react-router-dom";
import { useAppContext } from "../../context/app.context";
import { useTelegram } from "../../hooks/useTelegram";
import "./Header.scss";
import Nav from "./Nav";

const Header: FC = () => {
  const { user } = useTelegram();

  const { cartItems, userData } = useAppContext();
  const cartTotal = cartItems?.reduce((a, b) => a + b.quantity, 0) || 0;

  return (
    <header className="header">
      <div className="content">
        <svg
          width="30px"
          height="30px"
          viewBox="0 0 24 24"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
          className="instagram-icon"
        >
          <path
            d="M16.65 7.2H16.66M8 20H16C18.2091 20 20 18.2091 20 16V8C20 5.79086 18.2091 4 16 4H8C5.79086 4 4 5.79086 4 8V16C4 18.2091 5.79086 20 8 20ZM15.75 12C15.75 14.0711 14.0711 15.75 12 15.75C9.92893 15.75 8.25 14.0711 8.25 12C8.25 9.92893 9.92893 8.25 12 8.25C14.0711 8.25 15.75 9.92893 15.75 12Z"
            stroke="#000000"
            strokeWidth="2"
            strokeLinecap="round"
            strokeLinejoin="round"
          />
        </svg>
        <div className="logo">
          <Link to={"/"}>
            <svg
              viewBox="0 0 1357 267"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M17.5781 54H46.875L97.8125 178.375H99.6875L150.625 54H179.922V214H156.953V98.2187H155.469L108.281 213.766H89.2188L42.0313 98.1406H40.5469V214H17.5781V54ZM228.535 214H202.91L260.488 54H288.379L345.957 214H320.332L275.098 83.0625H273.848L228.535 214ZM232.832 151.344H315.957V171.656H232.832V151.344ZM342.266 74.7812V54H466.094V74.7812H416.172V214H392.109V74.7812H342.266ZM493.457 214V54H550.488C562.884 54 573.171 56.1354 581.348 60.4062C589.577 64.6771 595.723 70.5885 599.785 78.1406C603.848 85.6406 605.879 94.3125 605.879 104.156C605.879 113.948 603.822 122.568 599.707 130.016C595.645 137.411 589.499 143.167 581.27 147.281C573.092 151.396 562.806 153.453 550.41 153.453H507.207V132.672H548.223C556.035 132.672 562.389 131.552 567.285 129.312C572.233 127.073 575.853 123.818 578.145 119.547C580.436 115.276 581.582 110.146 581.582 104.156C581.582 98.1146 580.41 92.8802 578.066 88.4531C575.775 84.026 572.155 80.6406 567.207 78.2969C562.311 75.901 555.879 74.7031 547.91 74.7031H517.598V214H493.457ZM572.441 141.812L611.973 214H584.473L545.723 141.812H572.441ZM635.254 214V54H735.566V74.7812H659.395V123.531H730.332V144.234H659.395V193.219H736.504V214H635.254ZM855.078 96.0312C854.245 88.6354 850.807 82.9062 844.766 78.8437C838.724 74.7292 831.12 72.6719 821.953 72.6719C815.391 72.6719 809.714 73.7135 804.922 75.7969C800.13 77.8281 796.406 80.6406 793.75 84.2344C791.146 87.776 789.844 91.8125 789.844 96.3438C789.844 100.146 790.729 103.427 792.5 106.187C794.323 108.948 796.693 111.266 799.609 113.141C802.578 114.964 805.755 116.5 809.141 117.75C812.526 118.948 815.781 119.937 818.906 120.719L834.531 124.781C839.635 126.031 844.87 127.724 850.234 129.859C855.599 131.995 860.573 134.807 865.156 138.297C869.74 141.786 873.438 146.109 876.25 151.266C879.115 156.422 880.547 162.594 880.547 169.781C880.547 178.844 878.203 186.891 873.516 193.922C868.88 200.953 862.135 206.5 853.281 210.562C844.479 214.625 833.828 216.656 821.328 216.656C809.349 216.656 798.984 214.755 790.234 210.953C781.484 207.151 774.635 201.76 769.688 194.781C764.74 187.75 762.005 179.417 761.484 169.781H785.703C786.172 175.562 788.047 180.38 791.328 184.234C794.661 188.036 798.906 190.875 804.063 192.75C809.271 194.573 814.974 195.484 821.172 195.484C827.995 195.484 834.063 194.417 839.375 192.281C844.74 190.094 848.958 187.073 852.031 183.219C855.104 179.312 856.641 174.755 856.641 169.547C856.641 164.807 855.286 160.927 852.578 157.906C849.922 154.885 846.302 152.385 841.719 150.406C837.188 148.427 832.057 146.682 826.328 145.172L807.422 140.016C794.609 136.526 784.453 131.396 776.953 124.625C769.505 117.854 765.781 108.896 765.781 97.75C765.781 88.5312 768.281 80.4844 773.281 73.6094C778.281 66.7344 785.052 61.3958 793.594 57.5938C802.135 53.7396 811.771 51.8125 822.5 51.8125C833.333 51.8125 842.891 53.7135 851.172 57.5156C859.505 61.3177 866.068 66.5521 870.859 73.2187C875.651 79.8333 878.151 87.4375 878.359 96.0312H855.078ZM909.395 214V54H933.535V123.531H1013.3V54H1037.52V214H1013.3V144.234H933.535V214H909.395ZM1072.68 214V54H1096.82V130.406H1098.77L1165.88 54H1196.27L1131.74 126.031L1196.5 214H1167.44L1115.72 142.516L1096.82 164.234V214H1072.68ZM1232.29 214H1206.66L1264.24 54H1292.13L1349.71 214H1324.08L1278.85 83.0625H1277.6L1232.29 214ZM1236.58 151.344H1319.71V171.656H1236.58V151.344Z"
                fill="black"
              />
              <ellipse
                cx="653.284"
                cy="15"
                rx="14.2842"
                ry="15"
                fill="#DE1414"
              />
              <ellipse
                cx="704.707"
                cy="15"
                rx="14.2842"
                ry="15"
                fill="#DE1414"
              />
            </svg>
          </Link>
        </div>
        <div className={"cart"}>
          <span className={"username"}>{user?.username ?? "Привет!"}</span>
          <Link to={"/cart"}>
            <div className={"icon"}>
              <span className={"icon_num"}>{cartTotal}</span>
              <svg
                width="30px"
                height="30px"
                viewBox="0 0 24 24"
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
              >
                <circle
                  cx="7.5"
                  cy="18.5"
                  r="1.5"
                  fill="var(--tg-theme-text-color)"
                />
                <circle
                  cx="16.5"
                  cy="18.5"
                  r="1.5"
                  fill="var(--tg-theme-text-color)"
                />
                <path
                  stroke="var(--tg-theme-text-color)"
                  strokeLinecap="round"
                  strokeLinejoin="round"
                  strokeWidth="2"
                  d="M3 5h2l.6 3m0 0L7 15h10l2-7H5.6z"
                />
              </svg>
            </div>
          </Link>
        </div>
      </div>
      <Nav id={userData.telegram_id} />
    </header>
  );
};

export default Header;
